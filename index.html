<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏Ñ‡∏ô‡∏Å‡∏≤‡∏Å‡πÜ‡∏ù‡∏∂‡∏Å‡∏û‡∏¥‡∏°‡∏û‡πå - ‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°‡∏ñ‡∏∂‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå</title>
    <link rel="icon" type="image/png" href="https://img2.pic.in.th/imageae5557eb3dd57c75.png">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #3bb154;
            --primary1: #201a33;
            --bg: #060a2ccb;
            --card: #000000;
            --text-dark: #1e293b;
            --text-light: hsl(328, 17%, 81%);
            --highlight: #ffc800ec;
        }

        body {
            background-color: var(--bg);
            font-family: 'Sarabun', sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: var(--text-dark);
            padding-top: 40px; 
        }

        /* ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô Ticker ‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô */
        .ticker-wrap {
            position: fixed; top: 0; left: 0; width: 100%; height: 65px;
            background-color: #000000e6; color: #fff; display: flex;
            align-items: center; overflow: hidden; z-index: 9999;
            border-bottom: 2px solid var(--primary);
        }
        .ticker-content {
            white-space: nowrap; padding-left: 100%; display: inline-block;
            animation: ticker 13s linear infinite; font-size: 20px; font-weight: 600;
        }
        @keyframes ticker {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }

        .main-container { width: 95%; max-width: 1100px; text-align: center; display: none; position: relative; }

        .top-actions { position: absolute; top: -60px; right: 0; display: flex; gap: 10px; flex-wrap: wrap; justify-content: flex-end; }
        .btn-top { background: #333; color: white; border: none; padding: 8px 15px; border-radius: 8px; cursor: pointer; font-size: 14px; transition: 0.2s;}
        .btn-top:hover { background: #555; }
        .btn-danger { background: #ef4444; }
        .btn-danger:hover { background: #dc2626; }

        h1 { font-weight: 700; color: var(--primary); margin-bottom: 30px; letter-spacing: -1px; }
        h2 { font-weight: 900; color: var(--primary1); margin-bottom: 10px; letter-spacing: -3px; }

        .typing-card {
            background: var(--card); padding: 50px; border-radius: 24px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4); margin-bottom: 30px; position: relative;
        }

        .display-window { height: 140px; overflow: hidden; position: relative; margin-bottom: 40px; }
        
        #wordContainer {
            position: absolute; top: 0; left: 0; width: 100%; display: flex; flex-wrap: wrap;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); text-align: left;
        }

        .word { font-size: 44px; line-height: 75px; margin-right: 18px; color: var(--text-light); padding: 0 12px; border-radius: 8px; transition: all 0.2s; }
        .word.current { background-color: var(--highlight); color: #000; font-weight: 600; box-shadow: 0 4px 12px rgba(255, 212, 59, 0.4); }
        .word.correct { color: green; }
        .word.wrong { color: red; text-decoration: line-through; }

        .controls-row { display: flex; gap: 20px; align-items: center; }
        #userInput {
            flex: 1; font-family: 'Sarabun', sans-serif; font-size: 28px; padding: 18px 25px;
            border: 2px solid #e2e8f0; border-radius: 16px; outline: none; background: #f1f5f9; color: var(--text-dark); transition: color 0.2s;
        }

        .timer-badge { background: var(--primary); color: white; padding: 15px 35px; border-radius: 16px; font-size: 32px; font-weight: 700; min-width: 70px; }
        .btn-refresh { background: #fff; border: 2px solid #e2e8f0; width: 70px; height: 70px; border-radius: 16px; cursor: pointer; font-size: 28px; color: var(--text-light); }

        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(10, 10, 15, 0.9); backdrop-filter: blur(8px);
            display: none; justify-content: center; align-items: center; z-index: 10000;
        }

        .modal-card {
            background: white; width: 90%; max-width: 550px; padding: 40px;
            border-radius: 30px; text-align: center; max-height: 85vh; overflow-y: auto;
        }

        /* ----- ‡∏™‡πÑ‡∏ï‡∏•‡πå Dark Minimal Popup (‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏°‡∏∂‡∏á) ----- */
        .dark-modal {
            background: #121212; border: 1px solid #333; box-shadow: 0 10px 40px rgba(0,0,0,0.8);
            border-radius: 20px; color: #fff; width: 90%; max-width: 400px; padding: 30px;
        }
        .dark-modal h2 { color: #fff; letter-spacing: 0; margin-top: 0; font-size: 24px; border-bottom: 1px solid #222; padding-bottom: 15px;}
        .dark-modal p { color: #aaa; font-size: 15px; margin-bottom: 25px; line-height: 1.5; }
        .dark-input {
            width: 100%; padding: 12px; margin-bottom: 15px; background: #000; border: 1px solid #333;
            color: var(--primary); border-radius: 8px; font-size: 16px; box-sizing: border-box; outline: none; transition: 0.3s;
        }
        .dark-input:focus { border-color: var(--primary); box-shadow: 0 0 10px rgba(59, 177, 84, 0.2); }
        .dark-btn-group { display: flex; gap: 10px; }
        .dark-btn { flex: 1; padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; transition: 0.2s; font-size: 15px; }
        .dark-btn.confirm { background: var(--primary); color: #000; }
        .dark-btn.confirm:hover { background: #2f8d43; }
        .dark-btn.cancel { background: #333; color: #fff; }
        .dark-btn.cancel:hover { background: #444; }
        .dark-btn.danger { background: #dc2626; color: #fff; }
        .dark-btn.danger:hover { background: #b91c1c; }

        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .stat-box { background: #f8fafc; padding: 12px; border-radius: 15px; border: 1px solid #eee; }
        .stat-val { font-size: 28px; font-weight: 700; color: var(--primary); }
        .stat-label { font-size: 13px; color: #64748b; }

        .rank-badge { background: #ffd43b; color: #000; padding: 10px 25px; border-radius: 50px; font-weight: 700; font-size: 18px; margin-bottom: 10px; display: inline-block; }

        .rank-table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 13px; text-align: left; }
        .rank-table tr { border-bottom: 1px solid #eee; }
        .rank-table td, .rank-table th { padding: 10px; color:#333; }
        .active-rank { background: #fff1f2; font-weight: bold; }

        #authSection { background: #000; padding: 40px; border-radius: 24px; width: 320px; text-align: center; color: white; }
        .auth-input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #333; background: #111; color: white; box-sizing: border-box; }
        .btn-main { background: var(--primary); color: white; border: none; width: 100%; padding: 15px; border-radius: 12px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        
        .sync-status { font-size: 12px; color: #666; margin-top: 10px; }
    </style>
</head>
<body>

<div class="ticker-wrap" id="tickerWrap">
    <div class="ticker-content" id="tickerContent">üì¢ ‡πÅ‡∏õ‡πä‡∏ö‡πÑ‡∏≠‡πâ‡∏™‡∏±‡∏™‡∏ô‡∏£‡∏Å</div>
</div>

<div id="authSection">
    <h2 style="color:red">‚å®Ô∏è ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Å‡∏≤‡∏Å‡πÜ</h2>
    <input type="text" id="usernameInput" class="auth-input" placeholder="‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏°‡∏∂‡∏á‡∏Å‡∏π‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å">
    <input type="password" id="passwordInput" class="auth-input" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏°‡∏∂‡∏á ‡∏à‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏•‡πà‡∏∞">
    <button class="btn-main" onclick="handleAuth()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ù‡∏∂‡∏Å‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Å‡∏≤‡∏Å‡πÜ‡∏Ç‡∏≠‡∏á‡∏°‡∏∂‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</button>
</div>

<div class="main-container" id="gameMain">
    <div class="top-actions">
        <button class="btn-top" onclick="showEditName()">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠</button>
        <button class="btn-top" onclick="showChangePassword()">üîë ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™</button>
        <button class="btn-top btn-danger" onclick="showDeleteAccount()">üóëÔ∏è ‡∏•‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</button>
        <button class="btn-top" onclick="showRanking()">üèÜ ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏û‡∏ß‡∏Å‡∏Å‡∏≤‡∏Å‡πÜ</button>
        <button class="btn-top" onclick="handleLogout()">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
    </div>
    
    <div style="display:flex; justify-content: space-between; margin-bottom: 10px; color: white; font-size: 14px;">
        <span>üë§ ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏≤‡∏Å‡πÜ: <b id="displayUser" style="color:var(--highlight)"></b></span>
        <span>üèÜ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏∂‡∏á‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <b id="bestWPM" style="color:var(--highlight)">0</b> WPM</span>
    </div>

    <h1>‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏î‡∏û‡∏¥‡∏°‡∏û‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏Å‡∏≤‡∏Å‡πÜ ‡∏ß‡πà‡∏≤‡∏á‡πÜ</h1>
    <h2> HY‡πÅ‡∏ú‡∏ô‡∏Å 2 </h2>

    <div class="typing-card">
        <div class="display-window">
            <div id="wordContainer"></div>
        </div>
        <div class="controls-row">
            <input type="text" id="userInput" placeholder="‡∏£‡∏µ‡∏ö‡∏û‡∏¥‡∏°‡∏û‡πå ‡∏≠‡∏¢‡πà‡∏≤‡πÅ‡∏≠‡πá‡∏Ñ‡πÄ‡∏Å‡∏¥‡∏ô" autocomplete="off">
            <div class="timer-badge" id="timer">60</div>
            <button class="btn-refresh" onclick="resetGame()">‚Üª</button>
        </div>
    </div>
</div>

<div class="modal-overlay" id="resultModal">
    <div class="modal-card">
        <h2>‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏°‡∏∂‡∏á</h2>
        <div class="rank-badge" id="resRankBadge">‡∏£‡∏∞‡∏î‡∏±‡∏ö</div>
        
        <div class="stats-grid">
            <div class="stat-box"><div class="stat-label">WPM</div><div class="stat-val" id="resWpm">0</div></div>
            <div class="stat-box"><div class="stat-label">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡πÄ‡∏´‡∏¢‡∏î‡πÜ</div><div class="stat-val" id="resAcc">0%</div></div>
            <div class="stat-box"><div class="stat-label">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ñ‡∏π‡∏Å‡πÄ‡∏ó‡∏û‡∏ß‡πà‡∏∞</div><div class="stat-val" style="color:#10b981" id="resCorrect">0</div></div>
            <div class="stat-box"><div class="stat-label">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ú‡∏¥‡∏î‡∏Å‡∏≤‡∏Å‡∏™‡∏±‡∏™</div><div class="stat-val" style="color:#ef4444" id="resWrong">0</div></div>
            <div class="stat-box" style="grid-column: span 2;"><div class="stat-label">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏Å‡∏≤‡∏Å‡πÜ‡πÑ‡∏õ</div><div class="stat-val" style="color:#3b82f6" id="resAttempts">0</div></div>
        </div>

        <div id="syncStatus" class="sync-status">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ô‡∏∞‡πÑ‡∏≠‡πâ‡∏™‡∏±‡∏™</div>
        <button class="btn-main" onclick="resetGame()">‡∏Å‡πá‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏î‡∏¥‡∏ß‡∏∞ ‡∏û‡∏≠‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏≠‡πÅ‡∏Ñ‡πà‡∏ô‡∏µ‡πâ</button>
    </div>
</div>

<div class="modal-overlay" id="rankingModal">
    <div class="modal-card">
        <h2>üìä ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Å‡∏≤‡∏Å‡πÜ ‡∏Ç‡∏≠‡∏á‡∏û‡∏ß‡∏Å‡∏°‡∏∂‡∏á</h2>
        <table class="rank-table">
            <thead><tr><th>#</th><th>‡∏ä‡∏∑‡πà‡∏≠</th><th>WPM</th><th>‡∏£‡∏∞‡∏î‡∏±‡∏ö</th></tr></thead>
            <tbody id="lbBody"></tbody>
        </table>
        <button class="btn-main" style="background:#666; margin-top:20px;" onclick="closeModal('rankingModal')">‡∏õ‡∏¥‡∏î</button>
    </div>
</div>

<div class="modal-overlay" id="darkActionModal">
    <div class="modal-card dark-modal">
        <h2 id="darkTitle">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</h2>
        <p id="darkDesc">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</p>
        
        <input type="text" id="darkInput1" class="dark-input" style="display:none;">
        <input type="password" id="darkInput2" class="dark-input" style="display:none;">
        
        <div class="dark-btn-group">
            <button class="dark-btn cancel" id="darkCancelBtn" onclick="closeModal('darkActionModal')">‡∏ä‡πà‡∏≤‡∏á‡πÅ‡∏°‡πà‡∏á</button>
            <button class="dark-btn confirm" id="darkConfirmBtn">‡∏à‡∏±‡∏î‡πÑ‡∏õ</button>
        </div>
    </div>
</div>

<script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw0JR-Rrt05HcgmGuOSbHB0GC4eeMCt4TQwWvAdbv6bHuOxmejpAnh2vSNl1Jdv6VEv/exec";
    
const fullWordList = [
  "‡∏û‡∏µ‡πà", "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô", "‡∏î‡∏≤‡∏ß", "‡∏ö‡∏¥‡∏ô", "‡πÇ‡∏™‡∏°", "‡πÅ‡∏™‡∏á", "‡πÇ‡∏ï", "‡πÉ‡∏´‡∏ç‡πà", "‡∏ô‡πâ‡∏≠‡∏¢", "‡πÅ‡∏ú‡∏ô‡∏Å","‡∏´‡πâ‡∏≠‡∏á","‡πÉ‡∏à","‡∏Å‡∏•‡∏∏‡πâ‡∏°","‡∏Å‡∏•‡∏∏‡πà‡∏°","‡∏Å‡∏≤‡∏Å","‡∏£‡πâ‡∏≤‡∏ô","‡∏ã‡πà‡∏≠‡∏°","‡∏ú‡∏≠‡∏°", "‡∏≠‡πâ‡∏ß‡∏ô", "‡∏≠‡πâ‡∏≠‡∏ô", "‡πÅ‡∏î‡∏á", "‡πÄ‡∏û‡∏•‡∏á", "‡∏´‡∏≠‡∏°", 
  "‡∏ï‡πà‡∏≠", "‡πÄ‡∏ï‡∏¥‡∏°", "‡∏´‡πâ‡∏≤‡∏°", "‡πÄ‡∏ä‡πá‡∏Ñ", "‡πÄ‡∏ä‡∏∑‡∏≠‡∏î", "‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô", "‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å", "‡∏û‡∏£‡πâ‡∏≠‡∏°", "‡∏™‡∏≥‡∏£‡∏≤‡∏ç", "‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å", "‡πÑ‡∏°‡πà‡∏ú‡∏¥‡∏î", "‡∏ñ‡∏π‡∏Å", "‡∏ú‡∏¥‡∏î", "‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©", 
  "‡∏û‡πà‡∏≠", "‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î", "‡∏õ‡πà‡∏ß‡∏¢", "‡∏´‡∏ß‡∏¢", "‡∏´‡∏°‡∏≤", "‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô", "‡∏°‡∏±‡∏á‡∏Å‡∏£", "‡∏á‡∏±‡∏ö", "‡∏°‡∏≠‡∏á", "‡∏î‡∏≤‡∏ß", "‡πÅ‡∏â", "‡πÑ‡∏û‡∏•‡∏¥‡∏ô", "‡∏õ‡∏≠‡∏¢", "‡∏°‡∏î", "‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°", 
  "‡πÉ‡∏à", "‡∏´‡∏±‡∏ß", "‡∏Å‡∏≥", "‡∏´‡∏°‡∏±‡∏î", "‡∏ä‡∏Å", "‡πÄ‡∏´‡∏µ‡πâ‡∏¢", "‡πÄ‡∏™‡∏∑‡∏≠‡∏Å", "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ", "‡∏à‡∏ô", "‡∏ô‡∏£‡∏Å", "‡∏°‡∏≤‡∏£", "‡∏î‡∏≠‡∏Å", "‡∏Å‡∏ö", "‡πÅ‡∏°‡∏ß", "‡∏Å‡πâ‡∏≠‡∏¢", "‡∏Å‡∏•‡πâ‡∏≤‡∏°", 
  "‡πÇ‡∏Å‡∏á", "‡∏´‡∏°‡∏µ", "‡∏´‡∏°‡∏ß‡∏¢", "‡∏™‡∏≤‡∏ß", "‡∏´‡∏ô‡∏∏‡πà‡∏°", "‡∏û‡∏π‡∏î", "‡∏•‡∏≤‡∏ö", "‡πÅ‡∏ï‡∏Å", "‡∏´‡∏ô‡πà‡∏≠", "‡∏´‡∏•‡πà‡∏≠", "‡∏ó‡∏£‡∏≤‡∏ö", "‡∏ó‡∏£‡∏≤‡∏¢", "‡∏ö‡∏≤‡∏á", "‡πÑ‡∏Å‡πà", "‡∏õ‡∏•‡∏≤", "‡∏ï‡πâ‡∏°", 
  "‡∏á‡∏á", "‡∏õ‡∏•‡∏≠‡∏°", "‡πÅ‡∏ó‡πâ", "‡∏à‡∏£‡∏¥‡∏á", "‡∏™‡∏¥‡∏ß", "‡∏•‡∏¥‡∏á", "‡∏™‡∏¥‡∏ö", "‡πÄ‡∏Å‡πâ‡∏≤", "‡∏´‡∏Å", "‡∏´‡πâ‡∏≤", "‡∏™‡∏µ‡πà", "‡∏™‡∏≤‡∏°", "‡∏™‡∏≠‡∏á", "‡∏™‡∏¥‡∏á", "‡∏Ñ‡∏ß‡∏≤‡∏¢", "‡∏à‡πâ‡∏≤", "‡∏Ç‡πâ‡∏≤", 
  "‡∏ü‡∏≤‡∏£‡πå‡∏°", "‡∏¢‡∏≤", "‡∏Å‡∏±‡∏ô", "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠", "‡∏•‡∏≥", "‡∏ó‡∏≠‡∏á", "‡∏™‡πâ‡∏°", "‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á", "‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß", "‡πÄ‡∏î‡∏¢‡πå", "‡∏û‡∏¥‡∏°‡∏û‡πå", "‡∏ó‡πâ‡∏≠‡∏á", "‡πÄ‡∏Å‡∏°", "‡∏à‡∏≥", "‡∏à‡∏≥‡∏ô‡∏≥", "‡∏û‡∏£‡∏∞", 
  "‡∏â‡∏±‡∏ô", "‡πÄ‡∏ò‡∏≠", "‡πÄ‡∏ß‡∏£", "‡πÄ‡∏û‡∏∑‡πà‡∏≠", "‡∏™‡∏±‡∏™", "‡∏Ñ‡∏ß‡∏¢", "‡∏™‡∏µ", "‡∏≠‡πâ‡∏≠", "‡∏´‡∏°‡∏≠", "‡∏´‡∏°‡πâ‡∏≠", "‡∏û‡∏≠", "‡∏ó‡πà‡∏≠", "‡∏ä‡∏ß‡∏ô", "‡∏ó‡∏ß‡∏µ", "‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô", "‡∏ä‡∏≠‡∏ö", "‡πÇ‡∏Ñ‡∏°", 
  "‡πÄ‡∏â‡∏û‡∏≤‡∏∞", "‡∏á‡∏≤‡∏ô", "‡∏ï‡∏£‡∏á", "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°", "‡∏Ç‡∏∂‡πâ‡∏ô", "‡∏Ç‡∏ß‡∏≤‡∏á", "‡∏¢‡πâ‡∏≠‡∏¢", "‡∏ä‡πâ‡∏≤", "‡∏Ñ‡∏π‡∏ì", "‡∏î‡∏á", "‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å", "‡πÄ‡∏ó‡πâ‡∏≤", "‡∏ã‡∏¥", "‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö", "‡∏ä‡∏µ‡∏û", "‡∏ä‡∏¥‡∏á", 
  "‡∏à‡∏±‡∏ö", "‡∏ä‡∏±‡πà‡∏ß", "‡πÉ‡∏Å‡∏•‡πâ", "‡∏î‡πâ‡∏ß‡∏¢", "‡∏ï‡∏£‡∏ß‡∏à", "‡∏ó‡∏≥‡πÑ‡∏°", "‡∏Å‡∏•‡πâ‡∏≤", "‡∏ä‡∏±‡∏ß‡∏£‡πå", "‡∏Ñ‡∏•‡∏≤‡∏¢", "‡∏ò‡∏£‡∏£‡∏°", "‡∏Å‡∏•‡∏≤‡∏á", "‡∏ï‡∏±‡∏î", "‡∏ô‡∏±‡πà‡∏á", "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô", "‡∏à‡∏£‡∏¥‡∏ï", "‡∏ó‡∏±‡πâ‡∏á", 
  "‡πÉ‡∏ï‡πâ", "‡πÄ‡∏î‡∏∑‡∏≠‡∏î", "‡πÅ‡∏î‡∏î", "‡∏ï‡∏≤‡∏°", "‡∏à‡∏∂‡∏á", "‡∏ï‡πâ‡∏ô", "‡∏ä‡πâ‡∏≤‡∏á", "‡∏ó‡∏±‡∏ô", "‡πÄ‡∏ä‡∏∑‡πâ‡∏≠", "‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß", "‡∏Ñ‡∏±‡∏ö", "‡∏Å‡∏•‡πà‡∏≤‡∏ß", "‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á", "‡πÇ‡∏ï‡πä‡∏∞", "‡∏Ñ‡∏•‡∏∏‡∏°", "‡∏ï‡∏£‡∏≤", 
  "‡∏Ñ‡πà‡∏≤", "‡∏ó‡∏´‡∏≤‡∏£", "‡πÅ‡∏à‡πâ‡∏á", "‡∏Ç‡∏±‡∏á", "‡∏Ç‡∏≤‡∏î", "‡πÄ‡∏à‡∏£‡∏¥‡∏ç", "‡∏Ç‡πâ‡∏≤‡∏á", "‡∏Å‡∏ß‡πâ‡∏≤‡∏á", "‡∏î‡∏±‡∏ö", "‡∏ä‡∏≤‡∏ï‡∏¥", "‡πÑ‡∏Å‡∏•", "‡πÅ‡∏Å‡∏∞", "‡∏î‡∏ß‡∏á", "‡∏Ç‡∏≠‡∏ö", "‡πÅ‡∏ñ‡∏ß", "‡∏á‡∏≤‡∏°", "‡∏Ç‡∏≤", 
  "‡πÉ‡∏Ñ‡∏£", "‡∏ï‡∏ô", "‡∏Ñ‡πà‡∏≥", "‡∏ä‡∏≤", "‡πÄ‡∏ï‡∏µ‡∏¢‡∏á", "‡πÅ‡∏à‡∏á", "‡∏î‡∏≥", "‡∏ó‡∏¥‡πâ‡∏á", "‡∏Ç‡∏¢‡∏≤‡∏¢", "‡∏à‡∏±‡∏Å", "‡∏î‡πâ‡∏≤‡∏ô", "‡∏ñ‡∏ß‡∏≤‡∏¢", "‡∏Ñ‡∏≠", "‡∏Å‡∏≤‡∏£", "‡∏ò‡∏á", "‡∏ä‡πà‡∏≠‡∏á", "‡πÄ‡∏Å‡∏¥‡∏ô", 
  "‡∏î‡∏∑‡πà‡∏°", "‡∏ï‡∏¥‡∏î", "‡∏ï‡πâ‡∏≠‡∏á", "‡∏ä‡πà‡∏≤‡∏á", "‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥", "‡∏à‡∏ö", "‡∏Ñ‡∏ì‡∏∞", "‡∏ó‡∏¥‡∏®", "‡πÄ‡∏Ç‡∏≤", "‡∏à‡∏î", "‡∏ï‡∏π‡πâ", "‡πÄ‡∏Ñ‡∏¢", "‡∏Ñ‡∏∞", "‡∏ñ‡∏ô‡∏ô", "‡∏Ñ‡∏ß‡∏£", "‡∏Å‡∏¥‡∏ô", "‡∏Å‡∏µ‡πà", 
  "‡∏Ç‡∏±‡∏î", "‡∏Å‡∏ß‡πà‡∏≤", "‡∏ä‡πà‡∏ß‡∏¢", "‡∏ã‡πâ‡∏≥", "‡∏ô‡∏≠‡∏ô", "‡∏î‡∏¥‡∏ô", "‡∏à‡∏á", "‡∏Å‡∏≤‡∏¢", "‡∏Å‡∏£‡∏∏‡∏á", "‡∏Ñ‡∏£‡∏≠‡∏á","‡πÄ‡∏´‡∏¢‡∏î", "‡πÄ‡∏´‡πà‡∏≤", "‡πÑ‡∏´‡∏•", "‡∏•‡πâ‡∏≤‡∏ô", "‡πÄ‡∏´‡∏°‡∏µ‡∏¢‡∏ß", "‡∏ö‡∏≠‡∏Å", "‡∏´‡∏¢‡∏≠‡∏Å", "‡πÄ‡∏ô‡∏¢", "‡∏≠‡πâ‡∏ß‡∏Å", "‡πÅ‡∏•‡∏Å", "‡∏ã‡∏∂‡πà‡∏á", "‡πÇ‡∏ä‡∏Ñ", "‡πÄ‡∏î‡πá‡∏Å", "‡πÄ‡∏ä‡πà‡∏ô", "‡∏Ç‡∏µ‡πà", "‡∏Ñ‡∏≠‡∏¢", 
  "‡∏Ç‡∏ô", "‡∏Ñ‡∏î‡∏µ", "‡πÑ‡∏Ç", "‡πÇ‡∏î‡∏¢", "‡∏Ç‡∏±‡∏ô", "‡∏à‡∏≤‡∏Å", "‡πÅ‡∏ó‡∏ô", "‡∏Å‡∏≤", "‡∏ó‡∏µ", "‡∏ó‡∏≤‡∏¢", "‡∏à‡∏¥‡∏ï", "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", "‡∏Ç‡πâ‡∏≤‡∏°", "‡πÄ‡∏Å‡∏≤‡∏∞", "‡∏à‡∏°", "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô", "‡∏ã‡πâ‡∏≤‡∏¢", 
  "‡πÄ‡∏á‡∏¥‡∏ô", "‡∏Ñ‡∏ô", "‡∏ï‡∏≥", "‡∏Å‡∏π‡πâ", "‡∏ó‡πâ‡∏≤‡∏¢", "‡∏ä‡∏ô", "‡∏Å‡πà‡∏≠", "‡∏î‡∏µ", "‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô", "‡πÄ‡∏á‡∏µ‡∏¢‡∏ö", "‡πÄ‡∏Ç‡∏ï", "‡πÇ‡∏ó‡∏©", "‡∏Ñ‡∏ß‡∏≤‡∏°", "‡∏Ç‡πâ‡∏≤‡∏ß", "‡∏ä‡∏±‡∏Å", "‡∏à‡∏±‡∏á", "‡∏Ç‡∏ì‡∏∞", 
  "‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå", "‡∏Ç‡∏ß‡∏î", "‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß", "‡∏à‡∏µ‡∏ô", "‡∏à‡∏∞", "‡πÉ‡∏ä‡πà", "‡∏ó‡∏≠‡∏î", "‡∏ï‡∏±‡πâ‡∏á", "‡∏Ñ‡∏£‡∏π", "‡∏ï‡∏±‡∏ß", "‡∏ï‡∏Å", "‡∏ñ‡∏≠‡∏¢", "‡πÄ‡∏ä‡πâ‡∏≤", "‡∏ô‡∏°", "‡∏Å‡πá", "‡∏ó‡∏£‡∏á", "‡∏ó‡∏≤", 
  "‡∏ò‡∏≤‡∏ï‡∏∏", "‡∏ä‡∏ô‡∏∞", "‡∏Å‡πâ‡∏≠‡∏ô", "‡πÇ‡∏á‡πà", "‡πÅ‡∏Å‡πâ", "‡∏Ñ‡∏≥", "‡∏ï‡∏≤‡∏¢", "‡∏ô‡∏±‡∏Å", "‡∏Ñ‡πâ‡∏≤", "‡∏ä‡∏µ‡πâ", "‡∏Ñ‡∏∑‡∏ô", "‡πÅ‡∏ï‡∏Å", "‡πÑ‡∏î‡πâ", "‡∏ï‡πà‡∏≥", "‡∏á‡∏≠‡∏Å", "‡∏à‡πà‡∏≤‡∏¢", "‡∏Ñ‡πâ‡∏ô", 
  "‡∏Ñ‡πà‡∏≠‡∏¢", "‡∏Ç‡∏≤‡∏¢", "‡∏Ç‡∏µ‡∏î", "‡∏Å‡∏•‡∏°", "‡∏ä‡∏±‡∏î", "‡πÄ‡∏î‡∏¥‡∏ô", "‡πÑ‡∏ó‡∏¢", "‡∏Ñ‡∏∑‡∏≠", "‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï", "‡∏Ç‡πà‡∏≤‡∏ß", "‡∏ç‡∏≤‡∏ï‡∏¥", "‡∏ó‡∏∏‡∏Å‡∏Ç‡πå", "‡∏ä‡∏ô‡∏¥‡∏î", "‡∏ó‡∏∞‡πÄ‡∏•", "‡πÄ‡∏ä‡∏∑‡πà‡∏≠", "‡πÄ‡∏ó", 
  "‡πÉ‡∏ä‡πâ", "‡πÄ‡∏Å‡∏¥‡∏î", "‡∏Ç‡∏ô‡∏≤‡∏î", "‡∏Å‡∏£‡∏£‡∏°", "‡∏ñ‡πâ‡∏≤", "‡πÄ‡∏î‡∏¥‡∏°", "‡∏ä‡∏∑‡πà‡∏≠", "‡πÅ‡∏ï‡πà‡∏á", "‡∏ó‡∏∏‡πà‡∏á", "‡∏ó‡∏∏‡∏Å", "‡∏ä‡∏±‡πâ‡∏ô", "‡∏á‡πà‡∏≤‡∏¢", "‡∏Ç‡∏±‡∏ö", "‡∏ï‡∏•‡∏≠‡∏î", "‡∏ô‡∏≠‡∏Å", "‡∏ï‡∏•‡∏≤‡∏î", 
  "‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î", "‡∏ñ‡∏≤‡∏°", "‡∏ï‡∏≤", "‡πÄ‡∏ñ‡∏µ‡∏¢‡∏á", "‡πÅ‡∏Å‡πâ‡∏ß", "‡πÄ‡∏à‡πá‡∏î", "‡πÄ‡∏à‡πâ‡∏≤", "‡∏Å‡∏£‡∏°", "‡∏ñ‡∏±‡πà‡∏ß", "‡∏Å‡∏•‡∏±‡∏ö", "‡πÄ‡∏ó‡πá‡∏à", "‡∏Å‡∏∞", "‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á", "‡πÑ‡∏ñ", "‡πÉ‡∏Ñ‡∏£‡πà", "‡∏à‡∏±‡∏î", 
  "‡∏Å‡∏≤‡∏ä‡∏≤‡∏î", "‡∏ï‡∏≠‡∏ô", "‡∏Å‡∏≤‡∏á", "‡∏ó‡∏π‡∏ï", "‡∏Å‡∏≥‡πÑ‡∏£", "‡∏î‡∏∏‡∏à", "‡πÅ‡∏à‡πà‡∏°", "‡πÄ‡∏Å‡πâ‡∏≤‡∏≠‡∏µ‡πâ", "‡∏â‡∏ö‡∏±‡∏ö", "‡πÄ‡∏Ç‡πâ‡∏≤", "‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢", "‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢", "‡∏ã‡πà‡∏≠‡∏ô", "‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏ß‡∏á", "‡∏ó‡∏±‡∏û", "‡πÇ‡∏Å‡∏£‡∏ò", "‡πÄ‡∏ó‡πà‡∏≤", "‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á", "‡∏ï‡πâ‡∏≠‡∏ô", "‡πÄ‡∏Å‡πà‡∏≤", "‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß", "‡πÇ‡∏à‡∏ó‡∏¢‡πå", "‡∏Ç‡∏≠‡∏á", "‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß", "‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á", "‡∏Å‡∏•‡∏±‡∏ß", "‡πÄ‡∏ï‡πá‡∏°", 
  "‡∏Å‡∏¥‡∏ô", "‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå", "‡∏Å‡∏£‡∏∞‡∏ó‡∏£‡∏ß‡∏á", "‡∏à‡∏±‡∏Å‡∏£", "‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢", "‡∏Ç‡∏≠", "‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô", "‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô", "‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô", "‡∏ô‡∏Ñ‡∏£", "‡∏Ñ‡∏£‡∏±‡πâ‡∏á", "‡πÅ‡∏Ç‡πá‡∏á", "‡∏ã‡∏∑‡πâ‡∏≠", "‡πÄ‡∏Å‡∏£‡∏á", 
  "‡∏Ñ‡∏π", "‡∏ó‡∏±‡∏ö", "‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç", "‡∏ó‡∏≤‡∏ô", "‡πÑ‡∏Ç‡πà", "‡∏Ñ‡∏∏‡∏ì", "‡∏ó‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß", "‡∏Ç‡πâ‡∏≤‡∏®‡∏∂‡∏Å", "‡∏â‡∏∞‡∏ô‡∏±‡πâ‡∏ô", "‡πÅ‡∏ï‡πà", "‡∏ä‡∏°", "‡∏Å‡∏≥‡∏´‡∏ô‡∏î", "‡∏Ñ‡πà‡∏∞", "‡∏ï‡∏∞‡πÄ‡∏Å‡∏µ‡∏¢‡∏á", "‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á", 
  "‡πÄ‡∏Å‡∏µ‡∏¢‡∏à", "‡∏ó‡∏±‡πà‡∏ß", "‡∏ó‡∏≤‡∏á", "‡∏Å‡∏™‡∏¥‡∏Å‡∏£‡∏£‡∏°", "‡∏ò‡∏∏‡∏£‡∏∞", "‡∏Å‡∏£", "‡∏â‡∏∞‡∏ô‡∏µ‡πâ", "‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô", "‡πÄ‡∏ñ‡∏¥‡∏î", "‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß", "‡∏Ñ‡∏¥‡∏î", "‡∏ô‡∏Å", "‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£", "‡∏Ç‡∏î", "‡∏î‡∏≥‡∏£‡∏¥", 
  "‡∏Ç‡∏≤‡∏ß", "‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤", "‡∏á‡∏π", "‡∏Å‡∏£‡∏∞‡∏ô‡∏±‡πâ‡∏ô", "‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô", "‡πÄ‡∏Å‡πá‡∏ö", "‡πÅ‡∏Ç‡∏Å", "‡∏à‡πâ‡∏≤‡∏á",  "‡∏ä‡∏≤‡∏¢‡∏´‡∏≤‡∏î", "‡∏ï‡∏∂‡∏Å", "‡∏ô‡πâ‡∏≠‡∏á", "‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏π", 
  "‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö", "‡∏ó‡∏ô", "‡∏Å‡∏∏‡∏°‡∏≤‡∏£", "‡∏ó‡∏î‡∏•‡∏≠‡∏á", "‡∏ó‡∏≤‡∏ö", "‡πÄ‡∏à‡∏≤‡∏∞", "‡πÅ‡∏Å", "‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤", "‡∏ó‡∏π‡∏ô", "‡∏Ñ‡∏£‡∏∂‡πà‡∏á", "‡∏ó‡∏≥", "‡∏Å‡∏≠‡∏ö", "‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å", "‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏£", 
  "‡∏ä‡∏≤‡∏ß", "‡∏Å‡∏£‡∏∞‡∏î‡πâ‡∏≤‡∏á", "‡πÑ‡∏Ç‡πâ", "‡∏ä‡∏ô‡∏ß‡∏ô", "‡∏à‡∏≥‡∏û‡∏ß‡∏Å", "‡πÉ‡∏î", "‡∏à‡∏π‡∏ö", "‡πÑ‡∏ï‡πà", "‡∏ï‡πâ‡∏≤‡∏ô", "‡∏Å‡∏¥‡∏£‡∏¥‡∏¢‡∏≤", "‡πÇ‡∏Å‡∏£‡πà‡∏á", "‡πÄ‡∏ó‡∏µ‡∏¢‡∏°", "‡∏Ç‡∏≠‡∏£‡∏±‡∏ö", "‡πÑ‡∏â‡∏ô", "‡∏ï‡∏£‡∏∞‡∏Å‡∏π‡∏•", 
  "‡∏î‡∏±‡∏á", "‡∏ä‡∏≤‡∏¢", "‡∏Å‡πà‡∏≠‡∏ô", "‡∏ó‡∏≥‡∏•‡∏≤‡∏¢", "‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°", "‡πÄ‡∏ó‡∏ß‡∏î‡∏≤", "‡∏î‡∏π", "‡∏ï‡∏£‡∏±‡∏™", "‡∏Ñ‡∏•‡∏≠‡∏á", "‡∏ï‡∏∞‡∏ß‡∏±‡∏ô", "‡∏ó‡πà‡∏≤‡∏ô", "‡∏ñ‡πâ‡∏≠‡∏¢", "‡∏Å‡∏£‡∏∞‡∏ó‡∏≥", 
  "‡πÅ‡∏Å‡πà", "‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£", "‡∏ó‡∏ß‡∏µ‡∏õ", "‡πÄ‡∏Å‡∏•‡πâ‡∏≤", "‡∏ï‡∏≠‡∏ö", "‡πÄ‡∏à‡πá‡∏ö", "‡∏£‡πâ‡∏≠‡∏á", "‡∏ï‡πà‡∏≠‡∏¢", "‡∏û‡∏•‡∏≤‡∏ô", "‡∏ñ‡πâ‡∏ß‡∏¢", "‡∏´‡∏≠‡∏¢", "‡∏ö‡∏µ‡πâ", "‡∏Ç‡∏¢‡∏µ‡πâ", "‡∏ö‡∏î"
];
let words = [], currentIdx = 0, timeLeft = 60, isStarted = false, timer = null;
    let correctCount = 0, wrongCount = 0, totalTypeAttempts = 0, totalChars = 0, correctChars = 0, currentUser = "";

    window.onload = function() {
        const savedUser = localStorage.getItem('isLoggedIn');
        if (savedUser) {
            currentUser = savedUser;
            let db = JSON.parse(localStorage.getItem('typingDB_Final') || '{}');
            showGame(savedUser, db[savedUser] ? db[savedUser].best : 0);
        }
        loadTickerData(); 
        setInterval(loadTickerData, 30000); 
    };

function loadTickerData() {
    fetch(SCRIPT_URL)
    .then(res => res.json())
    .then(data => {
        if(data && data.length > 0) {
            let uniqueLatest = [];
            let seenNames = new Set();
            
            // ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏õ
            for (let i = data.length - 1; i >= 0; i--) {
                if (!seenNames.has(data[i].username)) {
                    uniqueLatest.push(data[i]);
                    seenNames.add(data[i].username);
                    if (uniqueLatest.length >= 2) break; // ‡πÄ‡∏≠‡∏≤‡πÅ‡∏Ñ‡πà 2 ‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô
                }
            }

            let tickerHtml = uniqueLatest.map(item => 
                // ‡∏£‡∏π‡∏õ‡∏°‡∏∂‡∏á ‡∏Å‡∏π‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÑ‡∏ß‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
                `<img src="https://img2.pic.in.th/image4a54c6aceb3df441.md.png" style="height: 45px; vertical-align: middle; margin-right: 5px;"> <b>${item.username}</b> ‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Å‡∏≤‡∏Å‡πÜ‡πÑ‡∏õ <b>${item.wpm} WPM</b> (${getRank(item.wpm)})`
            ).join(' &nbsp;&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp; ');

            document.getElementById('tickerContent').innerHTML = `üì¢ ‡πÅ‡∏á‡πä‡∏ô‡πÜ‡πÜ ‡πÇ‡∏´‡∏•‡πÄ‡∏ó‡∏™‡πÜ: &nbsp;&nbsp;&nbsp; ${tickerHtml}`;
        }
    })
    .catch(() => {
        document.getElementById('tickerContent').innerHTML = "üì¢ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Ticker ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ß‡πà‡∏∞ ‡∏ä‡πà‡∏≤‡∏á‡πÅ‡∏°‡πà‡∏á‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏∞‡∏Å‡∏±‡∏ô";
    });
}

    function getRank(wpm) {
        if (wpm <= 30) return `<img src="https://img5.pic.in.th/file/secure-sv1/imagecfaa905716e8f8ca.md.png" width="25" style="vertical-align:middle;"> ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏´‡∏°‡∏ß‡∏∞ ‡∏Å‡∏≤‡∏Å‡∏ß‡πà‡∏∞`;
        if (wpm <= 40) return `<img src="https://img5.pic.in.th/file/secure-sv1/imagee7b335b8644c6a0f.md.png" width="25" style="vertical-align:middle;"> ‡πÑ‡∏õ‡∏ù‡∏∂‡∏Å‡πÄ‡∏¢‡∏≠‡∏∞‡πÜ ‡∏¢‡∏±‡∏á‡∏≠‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà`;
        if (wpm <= 50) return `<img src="https://img2.pic.in.th/image2fdd9d164361e281.md.png" width="25" style="vertical-align:middle;"> ‡∏°‡∏∂‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏±‡∏î‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏£‡∏≠? `;
        if (wpm <= 60) return `<img src="https://img5.pic.in.th/file/secure-sv1/image290900a076ee86fd.md.png" width="25" style="vertical-align:middle;"> ‡πÄ‡∏´‡∏¢‡∏î‡πÜ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡πà‡∏á‡∏•‡∏∞‡∏ß‡πà‡∏∞`;
        if (wpm <= 66) return `<img src="https://img5.pic.in.th/file/secure-sv1/imageb2c8dd5a97fcbbd6.md.png" width="25" style="vertical-align:middle;"> ‡πÇ‡∏´‡∏î‡∏™‡∏±‡∏™‡∏£‡∏±‡∏™‡πÄ‡∏ã‡∏µ‡∏¢ ‡πÅ‡∏°‡πà‡πÄ‡∏¢‡πá‡∏î`;
        if (wpm <= 76) return `<img src="https://img5.pic.in.th/file/secure-sv1/image4104bcba1c517794.md.png" width="25" style="vertical-align:middle;"> ‡∏™‡∏∏‡∏î‡∏à‡∏±‡∏î ‡∏°‡∏∂‡∏á‡∏Å‡πá‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏ß‡πÑ‡∏õ`;
        if (wpm <= 85) return `<img src="https://img2.pic.in.th/image52451a7b24c0129a.md.png" width="25" style="vertical-align:middle;"> ‡πÑ‡∏≠‡πâ‡πÄ‡∏´‡∏µ‡πâ‡∏¢ ‡∏°‡∏∂‡∏á‡∏à‡∏∞‡∏™‡∏∏‡∏î‡πÑ‡∏õ‡∏•‡∏∞`;
        if (wpm <= 99)return `<img src="https://img2.pic.in.th/image70ac1e10293d80dd.md.png" width="25" style="vertical-align:middle;"> ‡∏°‡∏∂‡∏á‡∏à‡∏∞‡πÑ‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏•‡∏∞‡πÑ‡∏≠‡πâ‡πÄ‡∏ß‡∏£`;
        if (wpm <= 120)return `<img src="https://img2.pic.in.th/image7879c2ee29d6d391.md.png" width="25" style="vertical-align:middle;"> ‡πÇ‡∏Ñ‡∏ï‡∏£‡∏û‡πà‡∏≠‡πÇ‡∏Ñ‡∏ï‡∏£‡πÅ‡∏°‡πà‡πÑ‡∏ß‡∏à‡∏±‡∏î`;
        if (wpm <= 130) return `<img src="https://img2.pic.in.th/image0d2874d58475dbc7.md.png" width="25" style="vertical-align:middle;"> ‡πÄ‡∏£‡πá‡∏ß‡∏™‡∏±‡∏™ ‡πÉ‡∏Ñ‡∏£‡∏à‡∏∞‡∏™‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏ß‡∏∞‡πÅ‡∏°‡πà‡πÄ‡∏¢‡πá‡∏î`;
        return `<img src="https://playserver.in.th/user_image/server_icon/13889_131811298.jpg" width="25" style="vertical-align:middle;"> ‡∏ï‡∏±‡∏ß‡∏ï‡∏∂‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÉ‡∏ô‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó`;
}

    function handleAuth() {
        const user = document.getElementById('usernameInput').value.trim();
        const pass = document.getElementById('passwordInput').value.trim();
        if(!user || !pass) return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏î‡∏≠‡πÅ‡∏°‡πà‡πÄ‡∏¢‡πá‡∏î!");
        let db = JSON.parse(localStorage.getItem('typingDB_Final') || '{}');
        
        // --- ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏±‡∏ö‡∏û‡∏≤‡∏™‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô ---
        if (user === pass) {
            setupDarkModal("üö® ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏ï‡∏¥‡∏´‡∏ô‡πà‡∏≠‡∏¢‡πÑ‡∏≠‡πâ‡πÄ‡∏ß‡∏£!", "‡∏°‡∏∂‡∏á‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏î‡∏¥‡∏ü‡∏£‡∏∞!<br>‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏°‡∏µ‡∏Ñ‡∏ô‡πÑ‡∏õ‡∏•‡∏ö‡πÅ‡∏≠‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏≤‡∏ó‡πå‡∏Ç‡∏≠‡∏á‡∏°‡∏∂‡∏á ‡∏Å‡∏π‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞!!<br>(‡πÅ‡∏ï‡πà‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏à‡∏∞‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏∞‡∏Å‡∏±‡∏ô ‡∏ó‡∏ô‡∏Å‡∏≤‡∏Å‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô)", "‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏≠‡πâ‡∏™‡∏±‡∏™!", () => {
                proceedLogin(user, pass, db);
                closeModal('darkActionModal');
            }, "‡∏ã‡πà‡∏≠‡∏ô");
            
            // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏î‡∏∏‡∏î‡∏±‡∏ô
            document.getElementById('darkConfirmBtn').className = "dark-btn danger";
            document.getElementById('darkCancelBtn').style.display = "none";
            return;
        }

        proceedLogin(user, pass, db);
    }

    function proceedLogin(user, pass, db) {
        if(db[user] && db[user].pass !== pass) return alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏¥‡∏î‡πÑ‡∏≠‡πâ‡∏™‡∏±‡∏™ ‡∏°‡∏∂‡∏á‡∏à‡∏≥‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏≠?!");
        if(!db[user]) db[user] = { pass: pass, best: 0 };
        localStorage.setItem('typingDB_Final', JSON.stringify(db));
        localStorage.setItem('isLoggedIn', user);
        currentUser = user;
        showGame(user, db[user].best);
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á Dark Modal (‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô)
    function setupDarkModal(title, desc, confirmText, confirmAction, cancelText = "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å") {
        document.getElementById('darkTitle').innerHTML = title;
        document.getElementById('darkDesc').innerHTML = desc;
        document.getElementById('darkInput1').style.display = 'none';
        document.getElementById('darkInput1').value = '';
        document.getElementById('darkInput2').style.display = 'none';
        document.getElementById('darkInput2').value = '';
        
        let confirmBtn = document.getElementById('darkConfirmBtn');
        let cancelBtn = document.getElementById('darkCancelBtn');
        
        confirmBtn.innerHTML = confirmText;
        confirmBtn.className = "dark-btn confirm"; // reset class
        confirmBtn.onclick = confirmAction;
        
        cancelBtn.innerHTML = cancelText;
        cancelBtn.style.display = "block"; // reset display
        
        document.getElementById('darkActionModal').style.display = 'flex';
    }

    function showEditName() {
        setupDarkModal("‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏°‡∏∂‡∏á", "‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏î‡∏π‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏°‡∏≤‡πÄ‡∏•‡∏¢‡πÑ‡∏≠‡πâ‡∏™‡∏±‡∏™", "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠", () => {
            const newName = document.getElementById('darkInput1').value.trim();
            if(!newName || newName === currentUser) return;
            
            let db = JSON.parse(localStorage.getItem('typingDB_Final') || '{}');
            if(db[newName]) {
                document.getElementById('darkDesc').innerHTML = "<span style='color:red'>‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ñ‡∏ô‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏î‡∏¥‡∏ß‡∏∞!</span>";
                return;
            }

            const oldName = currentUser;
            db[newName] = db[oldName];
            delete db[oldName];
            
            localStorage.setItem('typingDB_Final', JSON.stringify(db));
            localStorage.setItem('isLoggedIn', newName);
            currentUser = newName;
            
            document.getElementById('displayUser').innerText = newName;
            closeModal('darkActionModal');
            
            // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö‡πÄ‡∏ô‡∏µ‡∏¢‡∏ô‡πÜ
            setupDarkModal("‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢", "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô '" + newName + "' ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢<br>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å...", "‡∏õ‡∏¥‡∏î", () => closeModal('darkActionModal'));
            document.getElementById('darkCancelBtn').style.display = "none";

            fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify({ action: 'editName', oldName: oldName, newName: newName })
            }).catch(() => console.log("‡πÅ‡∏à‡πâ‡∏á: ‡∏™‡πà‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏õ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏ô‡πá‡∏ï‡πÄ‡∏ô‡πà‡∏≤"));
        });
        
        document.getElementById('darkInput1').style.display = 'block';
        document.getElementById('darkInput1').placeholder = "‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏Ç‡∏≠‡∏á‡∏°‡∏∂‡∏á...";
        document.getElementById('darkInput1').value = currentUser;
        setTimeout(() => document.getElementById('darkInput1').focus(), 100);
    }

    function showChangePassword() {
        setupDarkModal("üîë ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏≤‡∏Å‡πÜ‡∏Ç‡∏≠‡∏á‡∏°‡∏∂‡∏á", "‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏´‡∏°‡πà‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ‡∏Å‡∏π‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏à‡∏≥‡πÉ‡∏´‡πâ", "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™", () => {
            const oldPass = document.getElementById('darkInput1').value.trim();
            const newPass = document.getElementById('darkInput2').value.trim();
            let db = JSON.parse(localStorage.getItem('typingDB_Final') || '{}');
            
            if(!oldPass || !newPass) return;
            if(db[currentUser].pass !== oldPass) {
                document.getElementById('darkDesc').innerHTML = "<span style='color:red'>‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏î‡∏¥‡∏°‡∏°‡∏∂‡∏á‡∏¢‡∏±‡∏á‡∏ú‡∏¥‡∏î‡πÄ‡∏•‡∏¢ ‡πÑ‡∏≠‡πâ‡∏Ñ‡∏ß‡∏≤‡∏¢!</span>";
                return;
            }
            if(currentUser === newPass) {
                document.getElementById('darkDesc').innerHTML = "<span style='color:red'>‡∏Å‡∏π‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏î‡πà‡∏≤‡πÑ‡∏õ‡∏´‡∏¢‡∏Å‡πÜ ‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ä‡∏∑‡πà‡∏≠!!</span>";
                return;
            }
            
            db[currentUser].pass = newPass;
            localStorage.setItem('typingDB_Final', JSON.stringify(db));
            closeModal('darkActionModal');
            
            setupDarkModal("‚úÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß", "‡∏£‡∏´‡∏±‡∏™‡∏Ç‡∏≠‡∏á‡∏°‡∏∂‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏≥‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢‡∏•‡πà‡∏∞‡πÑ‡∏≠‡πâ‡πÄ‡∏ß‡∏£", "‡∏õ‡∏¥‡∏î", () => closeModal('darkActionModal'));
            document.getElementById('darkCancelBtn').style.display = "none";
        });
        
        document.getElementById('darkInput1').style.display = 'block';
        document.getElementById('darkInput1').type = 'password';
        document.getElementById('darkInput1').placeholder = "‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Å‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏°‡∏∂‡∏á...";
        
        document.getElementById('darkInput2').style.display = 'block';
        document.getElementById('darkInput2').placeholder = "‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏Å‡∏≤‡∏Å...";
        setTimeout(() => document.getElementById('darkInput1').focus(), 100);
    }

    function showDeleteAccount() {
        setupDarkModal("üóëÔ∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏à‡∏∞‡∏•‡∏ö‡∏ó‡∏¥‡πâ‡∏á?", "‡∏°‡∏∂‡∏á‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ô‡∏∞‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏•‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ? <br><span style='color:#ef4444'>‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏≤‡∏¢‡∏´‡∏°‡∏î‡πÄ‡∏Å‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡πÄ‡∏ß‡πâ‡∏¢ ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ú‡∏∏‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Å‡∏¥‡∏î!</span>", "‡∏•‡∏ö‡πÅ‡∏°‡πà‡∏á‡πÄ‡∏•‡∏¢!", () => {
            let db = JSON.parse(localStorage.getItem('typingDB_Final') || '{}');
            delete db[currentUser];
            localStorage.setItem('typingDB_Final', JSON.stringify(db));
            closeModal('darkActionModal');
            alert("‡∏•‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏¥‡πâ‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡πÑ‡∏™‡∏´‡∏±‡∏ß‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏•‡∏∞");
            handleLogout();
        }, "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß");
        
        // ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏ô‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ß‡πÜ
        document.getElementById('darkConfirmBtn').className = "dark-btn danger";
    }

    function showGame(user, best) {
        document.getElementById('displayUser').innerText = user;
        document.getElementById('bestWPM').innerText = best;
        document.getElementById('authSection').style.display = 'none';
        document.getElementById('gameMain').style.display = 'block';
        init();
    }

    function handleLogout() {
        localStorage.removeItem('isLoggedIn');
        location.reload();
    }

    function showRanking() {
        document.getElementById('lbBody').innerHTML = "<tr><td colspan='4' style='text-align:center'>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>";
        document.getElementById('rankingModal').style.display = 'flex';

        fetch(SCRIPT_URL)
        .then(res => res.json())
        .then(data => {
            const bestScoresMap = {};
            data.forEach(item => {
                if (!bestScoresMap[item.username] || item.wpm > bestScoresMap[item.username].wpm) {
                    bestScoresMap[item.username] = item;
                }
            });
            const leaderboard = Object.values(bestScoresMap);
            leaderboard.sort((a, b) => b.wpm - a.wpm);

            let html = "";
            leaderboard.slice(0, 100).forEach((row, i) => {
                html += `<tr class="${row.username === currentUser ? 'active-rank' : ''}">
                    <td>${i+1}</td>
                    <td>${row.username}</td>
                    <td>${row.wpm}</td>
                    <td>${getRank(row.wpm)}</td>
                </tr>`;
            });
            document.getElementById('lbBody').innerHTML = html || "<tr><td colspan='4'>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>";
        })
        .catch(() => {
            document.getElementById('lbBody').innerHTML = "<tr><td colspan='4'>‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</td></tr>";
        });
    }

    function closeModal(id) { document.getElementById(id).style.display = 'none'; }

    function init() {
        words = [...fullWordList].sort(() => Math.random() - 0.5);
        document.getElementById('wordContainer').innerHTML = words.map((w, i) => `<span class="word" id="w-${i}">${w}</span>`).join('');
        currentIdx = 0; timeLeft = 60; isStarted = false; 
        correctCount = 0; wrongCount = 0; totalTypeAttempts = 0; totalChars = 0; correctChars = 0;
        document.getElementById('userInput').value = '';
        document.getElementById('userInput').style.color = 'var(--text-dark)'; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏µ‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°
        document.getElementById('userInput').disabled = false;
        document.getElementById('timer').innerText = 60;
        document.querySelectorAll('.modal-overlay').forEach(m => m.style.display = 'none');
        document.getElementById('wordContainer').style.transform = `translateY(0)`;
        updateFocus();
    }

    function updateFocus() {
        document.querySelectorAll('.word.current').forEach(el => el.classList.remove('current'));
        const active = document.getElementById(`w-${currentIdx}`);
        if(active) {
            active.classList.add('current');
            if(active.offsetTop > 40) document.getElementById('wordContainer').style.transform = `translateY(-${active.offsetTop - 10}px)`;
        }
    }

    document.getElementById('userInput').addEventListener('input', (e) => {
        if(!isStarted && e.target.value.length > 0) {
            isStarted = true;
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').innerText = timeLeft;
                if(timeLeft <= 0) endGame();
            }, 1000);
        }
        
        // ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏µ‡πÅ‡∏ö‡∏ö Real-time ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏Ç‡∏≠ (‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ñ‡∏π‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ú‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á)
        const val = e.target.value;
        const target = words[currentIdx];
        if (val.length > 0) {
            if (target.startsWith(val)) {
                e.target.style.color = '#10b981'; // ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏™‡∏ß‡∏¢‡πÜ
            } else {
                e.target.style.color = '#ef4444'; // ‡πÅ‡∏î‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏à
            }
        } else {
            e.target.style.color = 'var(--text-dark)';
        }
    });

    document.getElementById('userInput').addEventListener('keydown', (e) => {
        if(e.key === ' ' || e.key === 'Enter') {
            e.preventDefault();
            const val = document.getElementById('userInput').value.trim();
            if(!val) return;
            
            totalTypeAttempts++; 
            const target = words[currentIdx];
            totalChars += target.length;
            
            if(val === target) { 
                document.getElementById(`w-${currentIdx}`).classList.add('correct'); 
                correctCount++; 
                correctChars += target.length; 
            } else { 
                document.getElementById(`w-${currentIdx}`).classList.add('wrong'); 
                wrongCount++;
            }
            currentIdx++; 
            document.getElementById('userInput').value = '';
            document.getElementById('userInput').style.color = 'var(--text-dark)'; // ‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏™‡∏µ‡∏î‡∏≥
            updateFocus();
        }
    });

    function endGame() {
        clearInterval(timer);
        document.getElementById('userInput').disabled = true;
        const finalAcc = totalChars > 0 ? Math.round((correctChars/totalChars)*100) : 0;
        const rankMessage = getRank(correctCount);
        
        let db = JSON.parse(localStorage.getItem('typingDB_Final'));
        if(correctCount > db[currentUser].best) {
            db[currentUser].best = correctCount;
            localStorage.setItem('typingDB_Final', JSON.stringify(db));
            document.getElementById('bestWPM').innerText = correctCount;
        }

        document.getElementById('resWpm').innerText = correctCount;
        document.getElementById('resAcc').innerText = finalAcc + "%";
        document.getElementById('resCorrect').innerText = correctCount;
        document.getElementById('resWrong').innerText = wrongCount;
        document.getElementById('resAttempts').innerText = totalTypeAttempts;
        document.getElementById('resRankBadge').innerHTML = rankMessage;
        document.getElementById('resultModal').style.display = 'flex';
        document.getElementById('syncStatus').innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ô‡∏∞‡πÑ‡∏≠‡πâ‡∏™‡∏±‡∏™";

        const payload = {
            username: currentUser,
            wpm: correctCount,
            accuracy: finalAcc,
            correctWords: correctCount,
            wrongWords: wrongCount,
            totalAttempts: totalTypeAttempts,
            rank: rankMessage
        };

        fetch(SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify(payload)
        })
        .then(() => {
            document.getElementById('syncStatus').innerText = "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡πÅ‡∏°‡πà‡πÄ‡∏¢‡πá‡∏î";
            loadTickerData(); 
        })
        .catch(() => {
            document.getElementById('syncStatus').innerText = "‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÑ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏¢ " + rankMessage;
        });
    }

    function resetGame() { 
        clearInterval(timer); 
        init(); 
        setTimeout(() => document.getElementById('userInput').focus(), 100); 
    }
</script>
</body>
</html>
